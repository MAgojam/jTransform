
# This file is automatically generated, you probably don't want to edit this

jtTransposeOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "jtTransposeOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            varNme = NULL,
            varOth = NULL,
            fleOut = "Dataset_xpsd.omv",
            btnOut = NULL,
            blnOut = FALSE, ...) {

            super$initialize(
                package="jTransform",
                name="jtTranspose",
                requiresData=TRUE,
                ...)

            private$..varNme <- jmvcore::OptionVariable$new(
                "varNme",
                varNme,
                permitted=list(
                    "numeric",
                    "factor",
                    "id"),
                required=FALSE)
            private$..varOth <- jmvcore::OptionVariables$new(
                "varOth",
                varOth,
                permitted=list(
                    "numeric",
                    "factor",
                    "id"),
                required=TRUE)
            private$..fleOut <- jmvcore::OptionString$new(
                "fleOut",
                fleOut,
                default="Dataset_xpsd.omv")
            private$..btnOut <- jmvcore::OptionString$new(
                "btnOut",
                btnOut,
                hidden=TRUE)
            private$..blnOut <- jmvcore::OptionBool$new(
                "blnOut",
                blnOut,
                default=FALSE)

            self$.addOption(private$..varNme)
            self$.addOption(private$..varOth)
            self$.addOption(private$..fleOut)
            self$.addOption(private$..btnOut)
            self$.addOption(private$..blnOut)
        }),
    active = list(
        varNme = function() private$..varNme$value,
        varOth = function() private$..varOth$value,
        fleOut = function() private$..fleOut$value,
        btnOut = function() private$..btnOut$value,
        blnOut = function() private$..blnOut$value),
    private = list(
        ..varNme = NA,
        ..varOth = NA,
        ..fleOut = NA,
        ..btnOut = NA,
        ..blnOut = NA)
)

jtTransposeResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "jtTransposeResults",
    inherit = jmvcore::Group,
    active = list(
        txtInf = function() private$.items[["txtInf"]],
        txtOut = function() private$.items[["txtOut"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Transpose the dataset")
            self$add(jmvcore::Html$new(
                options=options,
                name="txtInf",
                title="",
                content="<b>This function transposes a dataset (i.e., rows are made into columns and columns into rows).</b><br> Please assign maximally one variable to the variable box \u201CVariable with column names for the output\u201D (this variable might contain names of trials or questionnaire items). If you leave the box empty, generic variable names are generated (\u201CV_...\u201D).<br> The variables to be transposed (i.e., those to become rows in your output data set) have to be assigned to \u201CVariables to be transposed\u201D.<br> Under \u201COutput file\u201D, you can adjust the name of the output file. You may also add a directory to the file name. If no path is given, the output file is stored in the home directory.<br>\n"))
            self$add(jmvcore::Html$new(
                options=options,
                name="txtOut",
                title="",
                content=""))}))

jtTransposeBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "jtTransposeBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "jTransform",
                name = "jtTranspose",
                version = c(1,0,0),
                options = options,
                results = jtTransposeResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = TRUE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Transpose the dataset
#'
#' Transpose the dataset
#'
#' @examples
#' # the function is a wrapper for jmvReadWrite::transpose_omv
#' # please use that function when using R
#' # for more information: https://sjentsch.github.io/jmvReadWrite
#'
#' @param data the data as a data frame
#' @param varNme a string containing the variable containing the variable
#'   names for the output data frame
#' @param varOth a vector of strings containing the names of the variables to
#'   be transposed
#' @param fleOut a string with name and location of the output file (the home
#'   directory, if no directory is given)
#' @param btnOut .
#' @param blnOut .
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$txtInf} \tab \tab \tab \tab \tab a html \cr
#'   \code{results$txtOut} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' @export
jtTranspose <- function(
    data,
    varNme,
    varOth,
    fleOut = "Dataset_xpsd.omv",
    btnOut,
    blnOut = FALSE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("jtTranspose requires jmvcore to be installed (restart may be required)")

    if ( ! missing(varNme)) varNme <- jmvcore::resolveQuo(jmvcore::enquo(varNme))
    if ( ! missing(varOth)) varOth <- jmvcore::resolveQuo(jmvcore::enquo(varOth))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(varNme), varNme, NULL),
            `if`( ! missing(varOth), varOth, NULL))


    options <- jtTransposeOptions$new(
        varNme = varNme,
        varOth = varOth,
        fleOut = fleOut,
        btnOut = btnOut,
        blnOut = blnOut)

    analysis <- jtTransposeClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

