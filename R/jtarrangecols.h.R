
# This file is automatically generated, you probably don't want to edit this

jtArrangeColsOptions <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "jtArrangeColsOptions",
    inherit = jmvcore::Options,
    public = list(
        initialize = function(
            varOrd = NULL,
            btnOut = NULL,
            blnOut = FALSE, ...) {

            super$initialize(
                package="jTransform",
                name="jtArrangeCols",
                requiresData=TRUE,
                ...)

            private$..varOrd <- jmvcore::OptionVariables$new(
                "varOrd",
                varOrd,
                permitted=list(
                    "numeric",
                    "factor",
                    "id"))
            private$..btnOut <- jmvcore::OptionString$new(
                "btnOut",
                btnOut,
                hidden=TRUE)
            private$..blnOut <- jmvcore::OptionBool$new(
                "blnOut",
                blnOut,
                default=FALSE,
                hidden=TRUE)

            self$.addOption(private$..varOrd)
            self$.addOption(private$..btnOut)
            self$.addOption(private$..blnOut)
        }),
    active = list(
        varOrd = function() private$..varOrd$value,
        btnOut = function() private$..btnOut$value,
        blnOut = function() private$..blnOut$value),
    private = list(
        ..varOrd = NA,
        ..btnOut = NA,
        ..blnOut = NA)
)

jtArrangeColsResults <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "jtArrangeColsResults",
    inherit = jmvcore::Group,
    active = list(
        txtPvw = function() private$.items[["txtPvw"]],
        txtInf = function() private$.items[["txtInf"]]),
    private = list(),
    public=list(
        initialize=function(options) {
            super$initialize(
                options=options,
                name="",
                title="Change the order of variables")
            self$add(jmvcore::Preformatted$new(
                options=options,
                name="txtPvw",
                title="Outout Preview",
                refs="jmvReadWrite"))
            self$add(jmvcore::Html$new(
                options=options,
                name="txtInf",
                content="<h2>Details</h2> <p><strong>This function re-arranges the order of columns in a jamovi data file.</strong></p> <p>Please assign the variables in their desired order to \u201CDesired order of variables\u201D. Please note that variables that you leave in the variable list to the left are not included in the output file.</p>\n"))}))

jtArrangeColsBase <- if (requireNamespace("jmvcore", quietly=TRUE)) R6::R6Class(
    "jtArrangeColsBase",
    inherit = jmvcore::Analysis,
    public = list(
        initialize = function(options, data=NULL, datasetId="", analysisId="", revision=0) {
            super$initialize(
                package = "jTransform",
                name = "jtArrangeCols",
                version = c(1,0,0),
                options = options,
                results = jtArrangeColsResults$new(options=options),
                data = data,
                datasetId = datasetId,
                analysisId = analysisId,
                revision = revision,
                pause = NULL,
                completeWhenFilled = TRUE,
                requiresMissings = FALSE,
                weightsSupport = 'auto')
        }))

#' Change the order of variables
#'
#' Change the order of variables
#'
#' @examples
#' \dontrun{
#' # the function is a wrapper for jmvReadWrite::arrange_cols_omv
#' # please use that function when using R
#' # for more information: https://sjentsch.github.io/jmvReadWrite
#'}
#' @param data .
#' @param varOrd .
#' @param btnOut .
#' @param blnOut .
#' @return A results object containing:
#' \tabular{llllll}{
#'   \code{results$txtPvw} \tab \tab \tab \tab \tab a preformatted \cr
#'   \code{results$txtInf} \tab \tab \tab \tab \tab a html \cr
#' }
#'
#' @export
jtArrangeCols <- function(
    data,
    varOrd,
    btnOut,
    blnOut = FALSE) {

    if ( ! requireNamespace("jmvcore", quietly=TRUE))
        stop("jtArrangeCols requires jmvcore to be installed (restart may be required)")

    if ( ! missing(varOrd)) varOrd <- jmvcore::resolveQuo(jmvcore::enquo(varOrd))
    if (missing(data))
        data <- jmvcore::marshalData(
            parent.frame(),
            `if`( ! missing(varOrd), varOrd, NULL))


    options <- jtArrangeColsOptions$new(
        varOrd = varOrd,
        btnOut = btnOut,
        blnOut = blnOut)

    analysis <- jtArrangeColsClass$new(
        options = options,
        data = data)

    analysis$run()

    analysis$results
}

